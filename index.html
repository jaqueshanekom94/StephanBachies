<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Bachelor Party Bingo ðŸŽ‰</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

  /* Reset & base */
  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    background: #fff9f0;
    color: #2c2c2c;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
    padding: 15px 10px;
  }
  h1 {
    text-align: center;
    font-weight: 600;
    margin-bottom: 12px;
    color: #d84315;
    font-size: 1.8rem;
  }
  #instructions {
    max-width: 400px;
    background: #fff3e0;
    border: 1.5px solid #fbc02d;
    border-radius: 12px;
    padding: 14px 18px;
    margin: 0 auto 18px auto;
    font-size: 14px;
    line-height: 1.5;
    box-shadow: 0 2px 6px rgba(251,192,45,0.3);
  }
  #userColor {
    display: inline-block;
    width: 22px;
    height: 22px;
    vertical-align: middle;
    border-radius: 50%;
    border: 1.5px solid #555;
    margin-left: 8px;
    box-shadow: 0 0 6px rgba(0,0,0,0.15);
  }
  table {
    border-collapse: separate;
    border-spacing: 10px;
    margin: 0 auto;
    width: 90vw;
    max-width: 440px;
    background: #fffbf6;
    padding: 15px;
    border-radius: 16px;
    box-shadow: 0 6px 12px rgba(216,67,21,0.2);
  }
  td {
    background: #ffe8d6;
    border-radius: 12px;
    border: 2.5px solid #d84315;
    padding: 14px 12px;
    text-align: center;
    vertical-align: middle;
    font-size: 13.5px;
    font-weight: 500;
    color: #5c2c0a;
    cursor: pointer;
    user-select: none;
    min-height: 70px;
    transition:
      background-color 0.3s ease,
      box-shadow 0.3s ease,
      color 0.25s ease;
    box-shadow: inset 0 0 0 transparent;
  }
  td.free-shot {
    font-weight: 700;
    background: #fdd835;
    color: #5d4037;
    box-shadow:
      0 0 8px 3px #fbc02d inset,
      0 0 12px 1px #f9a825;
  }
  td.marked {
    color: white !important;
    box-shadow:
      0 4px 8px rgba(0,0,0,0.25);
  }
  td.marked.free-shot {
    box-shadow:
      0 0 14px 5px #f57f17 inset,
      0 0 20px 3px #fbc02d;
  }
  td:hover:not(.marked) {
    background-color: #ffdca8;
  }
  #winnerMessage {
    max-width: 400px;
    margin: 18px auto 8px auto;
    font-weight: 700;
    font-size: 18px;
    color: #d84315;
    text-align: center;
    min-height: 28px;
  }
  #resetBtn {
    display: block;
    margin: 0 auto 20px auto;
    padding: 10px 28px;
    font-size: 17px;
    font-weight: 600;
    border: none;
    border-radius: 14px;
    background: #d84315;
    color: white;
    box-shadow: 0 4px 8px rgba(216,67,21,0.5);
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  #resetBtn:hover {
    background: #a32f0d;
  }
  #footer {
    text-align: center;
    font-size: 13px;
    color: #999;
    margin-top: auto;
    user-select: none;
  }
  @media (max-width: 380px) {
    td {
      font-size: 12px;
      min-height: 60px;
      padding: 12px 10px;
    }
    #instructions {
      font-size: 13px;
    }
    h1 {
      font-size: 1.5rem;
    }
  }
</style>
</head>
<body>

<h1>Bachelor Party Bingo ðŸŽ‰</h1>

<div id="instructions" role="region" aria-live="polite" aria-label="Game Instructions">
  <strong>Instructions:</strong><br/>
  Tap a square to mark or unmark it. Your color shows who marked it.<br/>
  Center square is a <span style="font-weight:bold;">free shot for Stephan!</span><br/>
  Get 4 in a row (horizontal, vertical, diagonal) to call <span style="font-weight:bold;">BINGO!</span><br/>
  The winner picks who drinks and <span style="font-weight:bold; color:#d84315;">Stephan takes a shot!</span><br/>
  Use the button below or refresh to clear all marks.<br/>
  Your color is: <span id="userColor" aria-label="Your assigned color"></span>
</div>

<table id="bingoTable" aria-label="Bachelor Party Bingo Grid" role="grid" tabindex="0">
  <!-- Bingo grid generated by script -->
</table>

<button id="resetBtn" aria-label="Clear all marks and reset the game">Clear All Marks</button>

<div id="winnerMessage" aria-live="assertive" role="alert"></div>

<div id="footer" aria-hidden="true">
  Stephan, when you read this, take another slikkie tjom, jou wil most trou!
</div>

<script>
  const bingoItems = [
    "Groom says 'I love you guys'",
    "Someone calls their partner",
    "Breaks their glass",
    "Drinks before 10:00",
    "Someone disappears for hours",
    "Someone takes a nap midday",
    "ðŸ¥ƒ FREE SHOT: STEPHAN",
    "Falls asleep in a weird place",
    "Someone throws up",
    "Someone falls",
    "Drinking game goes off the rails",
    "'Whenâ€™s the wedding?' question",
    "'Shot! Shot! Shot!' chant",
    "Group sings along to a song",
    "Awkward speech",
    "Someone passes out"
  ];

  const userColor = (function randomColor() {
    const colors = [
      '#e53935', '#8e24aa', '#3949ab', '#00897b',
      '#fdd835', '#fb8c00', '#6d4c41', '#039be5'
    ];
    return colors[Math.floor(Math.random() * colors.length)];
  })();
  document.getElementById('userColor').style.backgroundColor = userColor;

  const table = document.getElementById('bingoTable');
  const winnerMessage = document.getElementById('winnerMessage');

  let marks = Array(4).fill(null).map(() => Array(4).fill(''));

  function buildTable() {
    for(let r=0; r<4; r++) {
      const row = document.createElement('tr');
      for(let c=0; c<4; c++) {
        const cellIndex = r*4 + c;
        const cell = document.createElement('td');
        cell.textContent = bingoItems[cellIndex];
        cell.setAttribute('role', 'gridcell');
        cell.setAttribute('tabindex', '0');
        if (bingoItems[cellIndex].includes('FREE SHOT')) {
          cell.classList.add('free-shot');
        }
        cell.dataset.row = r;
        cell.dataset.col = c;
        cell.addEventListener('click', () => toggleMark(r, c, cell));
        cell.addEventListener('keydown', (e) => {
          if(e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            toggleMark(r, c, cell);
          }
        });
        row.appendChild(cell);
      }
      table.appendChild(row);
    }
  }

  function toggleMark(row, col, cell) {
    const currentMark = marks[row][col];
    if (currentMark === userColor) {
      marks[row][col] = '';
      cell.style.backgroundColor = '';
      cell.classList.remove('marked');
    } else if (currentMark === '') {
      marks[row][col] = userColor;
      cell.style.backgroundColor = userColor;
      cell.classList.add('marked');
      if (cell.classList.contains('free-shot')) {
        alert("ðŸ¥ƒ Stephan takes a shot now!");
      }
      checkBingo();
    } else {
      alert("This square is already marked by another player.");
    }
  }

  function checkBingo() {
    function fourInLine(cells) {
      if (cells[0] === '') return false;
      return cells.every(c => c === cells[0]);
    }

    for (let i=0; i<4; i++) {
      if (fourInLine(marks[i])) {
        announceWinner(marks[i][0]);
        return;
      }
      const colMarks = [marks[0][i], marks[1][i], marks[2][i], marks[3][i]];
      if (fourInLine(colMarks)) {
        announceWinner(colMarks[0]);
        return;
      }
    }
    const diag1 = [marks[0][0], marks[1][1], marks[2][2], marks[3][3]];
    if (fourInLine(diag1)) {
      announceWinner(diag1[0]);
      return;
    }
    const diag2 = [marks[0][3], marks[1][2], marks[2][1], marks[3][0]];
    if (fourInLine(diag2)) {
      announceWinner(diag2[0]);
      return;
    }
  }

  function announceWinner(winnerColor) {
    if (winnerMessage.textContent !== '') return;

    const winnerName = (winnerColor === userColor) ? "You" : "A player";
    winnerMessage.textContent = `${winnerName} got BINGO! ðŸŽ‰ Stephan must take a shot! Pick someone to drink!`;
    alert(`${winnerName} got BINGO! Stephan takes a shot! ðŸŽ‰`);
  }

  document.getElementById('resetBtn').addEventListener('click', () => {
    marks = Array(4).fill(null).map(() => Array(4).fill(''));
    winnerMessage.textContent = '';
    const cells = table.querySelectorAll('td');
    cells.forEach(cell => {
      cell.style.backgroundColor = '';
      cell.classList.remove('marked');
    });
  });

  buildTable();
</script>

</body>
</html>
